# improvements

f32
44, loss: 6.516855716705322, dt: 360.79ms, tok/sec: 2838.193518032083
45, loss: 6.5268402099609375, dt: 360.60ms, tok/sec: 2839.741674766108
46, loss: 7.35074520111084, dt: 361.91ms, tok/sec: 2829.430048973558
47, loss: 7.092875957489014, dt: 360.42ms, tok/sec: 2841.1092092329145
48, loss: 7.262147426605225, dt: 360.89ms, tok/sec: 2837.462249573056
49, loss: 7.13644552230835, dt: 361.06ms, tok/sec: 2836.062640813728

tf32
44, loss: 6.562320232391357, dt: 249.58ms, tok/sec: 4102.925753195912
45, loss: 6.517680644989014, dt: 248.01ms, tok/sec: 4128.855193841374
46, loss: 7.399937629699707, dt: 248.76ms, tok/sec: 4116.472913977042
47, loss: 7.174116611480713, dt: 247.78ms, tok/sec: 4132.621397038731
48, loss: 7.389693737030029, dt: 248.56ms, tok/sec: 4119.679071199531
49, loss: 7.250792026519775, dt: 249.57ms, tok/sec: 4102.984546103281

bf16
44, loss: 6.5555877685546875, dt: 187.62ms, tok/sec: 5457.766220299741
45, loss: 6.509521484375, dt: 188.12ms, tok/sec: 5443.461454422862
46, loss: 7.3783721923828125, dt: 187.84ms, tok/sec: 5451.524592973001
47, loss: 7.1530914306640625, dt: 188.53ms, tok/sec: 5431.634606921182
48, loss: 7.3604736328125, dt: 187.13ms, tok/sec: 5472.160310673278
49, loss: 7.220672607421875, dt: 188.25ms, tok/sec: 5439.607605629878

compile
44, loss: 6.559707164764404, dt: 158.85ms, tok/sec: 6446.441291159227
45, loss: 6.514993667602539, dt: 158.99ms, tok/sec: 6440.670098717705
46, loss: 7.3926239013671875, dt: 158.91ms, tok/sec: 6443.858927175588
47, loss: 7.16591739654541, dt: 158.73ms, tok/sec: 6451.292440289417
48, loss: 7.379026412963867, dt: 158.87ms, tok/sec: 6445.686678712714
49, loss: 7.239632606506348, dt: 159.26ms, tok/sec: 6429.919031807008

flash attention
44, loss: 6.55976676940918, dt: 151.17ms, tok/sec: 6773.616438485789
45, loss: 6.514967918395996, dt: 151.66ms, tok/sec: 6751.967904720283
46, loss: 7.392707824707031, dt: 151.69ms, tok/sec: 6750.620128160595
47, loss: 7.165891647338867, dt: 151.77ms, tok/sec: 6747.131145120193
48, loss: 7.379010200500488, dt: 151.70ms, tok/sec: 6750.089655074865
49, loss: 7.239564418792725, dt: 151.28ms, tok/sec: 6768.972646522975

vocab_size=50304
44, loss: 6.553337097167969, dt: 145.80ms, tok/sec: 7023.486416522898
45, loss: 6.521977424621582, dt: 146.59ms, tok/sec: 6985.606282051491
46, loss: 7.40291690826416, dt: 146.53ms, tok/sec: 6988.265962899266
47, loss: 7.2007246017456055, dt: 146.91ms, tok/sec: 6970.290102599557
48, loss: 7.422256946563721, dt: 146.54ms, tok/sec: 6987.74295973435
49, loss: 7.328115463256836, dt: 146.47ms, tok/sec: 6991.0187041694135

larning rate, 3e-4
44, loss: 6.537600517272949, dt: 154.31ms, tok/sec: 6635.962238847018, norm: 1.2631, lr 4.4714e-05
45, loss: 6.522396087646484, dt: 154.75ms, tok/sec: 6617.048382623914, norm: 1.4077, lr 4.0276e-05
46, loss: 7.350337028503418, dt: 155.74ms, tok/sec: 6574.888931752286, norm: 1.2654, lr 3.6607e-05
47, loss: 7.179737091064453, dt: 155.43ms, tok/sec: 6588.151201905746, norm: 1.3664, lr 3.3730e-05
48, loss: 7.464401721954346, dt: 155.25ms, tok/sec: 6595.749350402044, norm: 1.3927, lr 3.1662e-05
49, loss: 7.412684917449951, dt: 155.27ms, tok/sec: 6595.070774324019, norm: 2.1585, lr 3.0416e-05

larning rate, 6e-4
44, loss: 6.570123672485352, dt: 155.34ms, tok/sec: 6592.023967830064, norm: 1.4884, lr 8.9428e-05
45, loss: 6.587832927703857, dt: 154.68ms, tok/sec: 6620.261230252743, norm: 1.8381, lr 8.0553e-05
46, loss: 7.363733768463135, dt: 154.78ms, tok/sec: 6615.79468853156, norm: 1.4578, lr 7.3215e-05
47, loss: 7.19529914855957, dt: 155.17ms, tok/sec: 6599.0429332853955, norm: 1.9054, lr 6.7460e-05
48, loss: 7.399306297302246, dt: 155.06ms, tok/sec: 6604.085947566695, norm: 1.8287, lr 6.3324e-05
49, loss: 7.3701982498168945, dt: 154.61ms, tok/sec: 6623.007370946751, norm: 2.8968, lr 6.0832e-05

decay optimizer
44, loss: 6.588419437408447, dt: 136.65ms, tok/sec: 7493.788214685145, norm: 1.3725, lr 8.9428e-05
45, loss: 6.562193870544434, dt: 137.26ms, tok/sec: 7460.166914472313, norm: 1.5644, lr 8.0553e-05
46, loss: 7.366515159606934, dt: 136.60ms, tok/sec: 7496.2994632992695, norm: 1.2969, lr 7.3215e-05
47, loss: 7.193835735321045, dt: 136.93ms, tok/sec: 7478.0007486763225, norm: 1.5271, lr 6.7460e-05
48, loss: 7.4247941970825195, dt: 136.82ms, tok/sec: 7484.399040874366, norm: 1.4835, lr 6.3324e-05
49, loss: 7.3491530418396, dt: 136.78ms, tok/sec: 7486.473340456722, norm: 2.3964, lr 6.0832e-05

micro_batch
44, loss: 6.359553, dt: 823.16ms, tok/sec: 1243.9920940007553, norm: 1.0338, lr 8.9428e-05
45, loss: 6.376590, dt: 823.83ms, tok/sec: 1242.9764915035616, norm: 0.9846, lr 8.0553e-05
46, loss: 6.469552, dt: 823.28ms, tok/sec: 1243.8069226273803, norm: 1.3413, lr 7.3215e-05
47, loss: 6.397977, dt: 822.80ms, tok/sec: 1244.5234166325229, norm: 1.4767, lr 6.7460e-05
48, loss: 6.340066, dt: 823.56ms, tok/sec: 1243.3870689076175, norm: 1.3616, lr 6.3324e-05
49, loss: 6.231665, dt: 824.64ms, tok/sec: 1241.761463179107, norm: 1.0568, lr 6.0832e-05

micro_batch (correction for the number of processed tokens)
44, loss: 6.359560, dt: 0.82398s, tok/sec: 9941.94173387511, norm: 1.0341, lr 8.9428e-05
45, loss: 6.376503, dt: 0.82088s, tok/sec: 9979.552324794497, norm: 0.9846, lr 8.0553e-05
46, loss: 6.469543, dt: 0.82199s, tok/sec: 9966.014462432973, norm: 1.3406, lr 7.3215e-05
47, loss: 6.397924, dt: 0.82278s, tok/sec: 9956.527767217158, norm: 1.4759, lr 6.7460e-05
48, loss: 6.340064, dt: 0.82266s, tok/sec: 9957.94456953153, norm: 1.3604, lr 6.3324e-05
49, loss: 6.231693, dt: 0.82237s, tok/sec: 9961.440688098422, norm: 1.0566, lr 6.0832e-05
